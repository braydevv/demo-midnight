<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>browser vm | midnight</title>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/sidebar.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/themes.css">
  <link rel="stylesheet" href="css/wallpaper.css">
  <link rel="stylesheet" href="css/accessibility.css">
  <link rel="stylesheet" href="css/animations.css">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    /* VM-specific styles */
    .vm-container {
      margin-bottom: 50px;
    }
    
    .vm-options {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .vm-option {
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      cursor: pointer;
      transition: var(--transition-default);
      display: flex;
      align-items: center;
    }
    
    .vm-option:hover {
      transform: translateY(-5px);
    }
    
    .vm-option-icon {
      font-size: 32px;
      margin-right: 20px;
      color: var(--color-blue);
    }
    
    .vm-option-info {
      flex: 1;
    }
    
    .vm-option-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .vm-option-description {
      font-size: 14px;
      opacity: 0.7;
    }
    
    .vm-frame-container {
      position: relative;
      height: 600px;
      border-radius: 16px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      display: none;
    }
    
    .vm-frame-container.active {
      display: block;
    }
    
    .vm-frame {
      width: 100%;
      height: 100%;
      border: none;
    }
    
    .vm-controls {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 10px;
      z-index: 10;
    }
    
    .vm-control {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition-default);
      backdrop-filter: blur(5px);
    }
    
    .vm-control:hover {
      background: rgba(58, 174, 252, 0.5);
    }
    
    .vm-info {
      margin-top: 20px;
      background: var(--card-bg);
      border-radius: 20px;
      padding: 20px;
    }
    
    .vm-info-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .vm-info-content {
      font-size: 14px;
      line-height: 1.6;
    }
    
    .vm-info-content p {
      margin-bottom: 10px;
    }
    
    .vm-info-content ul {
      margin-left: 20px;
      margin-bottom: 10px;
    }
    
    .vm-info-content li {
      margin-bottom: 5px;
    }
    
    .vm-loading {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 5;
    }
    
    .vm-loading-spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255, 255, 255, 0.1);
      border-top-color: var(--color-blue);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .vm-loading-text {
      font-size: 18px;
      font-weight: 700;
    }
  </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body class="theme-deep-blue">
  <div class="app-container">
    <!-- Sidebar -->
    <div class="sidebar-container"></div>
    
    <!-- Content -->
    <div class="content">
      <div class="container">
        <!-- Header -->
        <div class="header-container"></div>
        
        <!-- VM Container -->
        <div class="vm-container">
          <h2>select a system to boot</h2>
          
          <div class="vm-options">
            <div class="vm-option" data-vm="freedos">
              <div class="vm-option-icon">
                <i class="fa-solid fa-floppy-disk"></i>
              </div>
              <div class="vm-option-info">
                <div class="vm-option-title">freedos</div>
                <div class="vm-option-description">lightweight dos-compatible operating system</div>
              </div>
            </div>
            
            <div class="vm-option" data-vm="linux">
              <div class="vm-option-icon">
                <i class="fa-solid fa-penguin"></i>
              </div>
              <div class="vm-option-info">
                <div class="vm-option-title">tiny linux</div>
                <div class="vm-option-description">minimal linux distribution</div>
              </div>
            </div>
            
            <div class="vm-option" data-vm="windows98">
              <div class="vm-option-icon">
                <i class="fa-solid fa-window-maximize"></i>
              </div>
              <div class="vm-option-info">
                <div class="vm-option-title">windows 98</div>
                <div class="vm-option-description">classic windows operating system</div>
              </div>
            </div>
          </div>
          
          <div class="vm-frame-container" id="vm-frame-container">
            <div class="vm-controls">
              <div class="vm-control" id="vm-restart">
                <i class="fa-solid fa-rotate-right"></i>
              </div>
              <div class="vm-control" id="vm-fullscreen">
                <i class="fa-solid fa-expand"></i>
              </div>
            </div>
            
            <div class="vm-loading" id="vm-loading">
              <div class="vm-loading-spinner"></div>
              <div class="vm-loading-text">loading virtual machine...</div>
            </div>
            
            <iframe class="vm-frame" id="vm-frame" allowfullscreen></iframe>
          </div>
          
          <div class="vm-info">
            <div class="vm-info-title">about browser vm</div>
            <div class="vm-info-content">
              <p>browser vm uses v86 to emulate x86-compatible cpu and hardware in your browser. this allows you to run operating systems like dos, linux, and windows directly in your browser without any plugins.</p>
              
              <p><strong>controls:</strong></p>
              <ul>
                <li><strong>fullscreen:</strong> expand the vm to fullscreen mode</li>
                <li><strong>capture mouse:</strong> lock your mouse to the vm (press esc to release)</li>
                <li><strong>restart:</strong> reboot the virtual machine</li>
              </ul>
              
              <p><strong>performance note:</strong> virtual machines run entirely in your browser and performance may vary depending on your device. for best results, use a modern computer with a fast processor.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- V86 Script -->
  <script src="https://cdn.jsdelivr.net/npm/v86@latest/build/libv86.js"></script>
  
  <!-- Scripts -->
  <script src="js/theme.js"></script>
  <script src="js/wallpaper.js"></script>
  <script src="js/sidebar.js"></script>
  <script src="js/header.js"></script>
  <script src="js/main.js"></script>
  
  <script>
    // VM functionality
    document.addEventListener('DOMContentLoaded', () => {
      // DOM elements
      const vmOptions = document.querySelectorAll('.vm-option');
      const vmFrameContainer = document.getElementById('vm-frame-container');
      const vmFrame = document.getElementById('vm-frame');
      const vmLoading = document.getElementById('vm-loading');
      const vmFullscreenBtn = document.getElementById('vm-fullscreen');
      const vmCaptureBtn = document.getElementById('vm-capture');
      const vmRestartBtn = document.getElementById('vm-restart');
      
      // V86 emulator instance
      let emulator = null;
      
      // VM configurations
      const vmConfigs = {
        freedos: {
          wasm_path: "https://cdn.jsdelivr.net/npm/v86@latest/build/v86.wasm",
          bios: { url: "https://cdn.jsdelivr.net/npm/v86@latest/bios/seabios.bin" },
          vga_bios: { url: "https://cdn.jsdelivr.net/npm/v86@latest/bios/vgabios.bin" },
          cdrom: { url: "https://cdn.jsdelivr.net/npm/v86@latest/images/freedos722.iso" },
          autostart: true,
          memory_size: 32 * 1024 * 1024,
          vga_memory_size: 2 * 1024 * 1024,
          boot_order: 0x132
        },
        linux: {
          wasm_path: "https://cdn.jsdelivr.net/npm/v86@latest/build/v86.wasm",
          bios: { url: "https://cdn.jsdelivr.net/npm/v86@latest/bios/seabios.bin" },
          vga_bios: { url: "https://cdn.jsdelivr.net/npm/v86@latest/bios/vgabios.bin" },
          cdrom: { url: "https://cdn.jsdelivr.net/npm/v86@latest/images/linux.iso" },
          autostart: true,
          memory_size: 64 * 1024 * 1024,
          vga_memory_size: 4 * 1024 * 1024,
          boot_order: 0x132
        },
        windows98: {
          wasm_path: "https://cdn.jsdelivr.net/npm/v86@latest/build/v86.wasm",
          bios: { url: "https://cdn.jsdelivr.net/npm/v86@latest/bios/seabios.bin" },
          vga_bios: { url: "https://cdn.jsdelivr.net/npm/v86@latest/bios/vgabios.bin" },
          hda: { url: "https://cdn.jsdelivr.net/npm/v86@latest/images/windows98.img" },
          autostart: true,
          memory_size: 64 * 1024 * 1024,
          vga_memory_size: 8 * 1024 * 1024,
          boot_order: 0x132
        }
      };
      
      // Start VM
      function startVM(vmType) {
        // Show loading
        vmLoading.style.display = 'flex';
        
        // Show VM container
        vmFrameContainer.classList.add('active');
        
        // Scroll to VM container
        vmFrameContainer.scrollIntoView({ behavior: 'smooth' });
        
        // Create emulator
        const config = vmConfigs[vmType];
        
        // If emulator already exists, destroy it
        if (emulator) {
          emulator.stop();
          emulator = null;
        }
        
        // Create new emulator
        emulator = new V86Starter({
          ...config,
          screen_container: vmFrame.contentDocument ? vmFrame.contentDocument.body : undefined
        });
        
        // Hide loading when VM is ready
        emulator.add_listener("emulator-ready", function() {
          vmLoading.style.display = 'none';
        });
      }
      
      // Restart VM
      function restartVM() {
        if (emulator) {
          emulator.restart();
        }
      }
      
      // Toggle fullscreen
      function toggleFullscreen() {
        if (!document.fullscreenElement) {
          vmFrameContainer.requestFullscreen().catch(err => {
            console.error(`Error attempting to enable fullscreen: ${err.message}`);
          });
        } else {
          document.exitFullscreen();
        }
      }
      
      // Toggle mouse capture
      function toggleMouseCapture() {
        if (emulator) {
          emulator.lock_mouse();
        }
      }
      
      // Event listeners
      vmOptions.forEach(option => {
        option.addEventListener('click', () => {
          const vmType = option.dataset.vm;
          startVM(vmType);
        });
      });
      
      vmFullscreenBtn.addEventListener('click', toggleFullscreen);
      vmCaptureBtn.addEventListener('click', toggleMouseCapture);
      vmRestartBtn.addEventListener('click', restartVM);
    });
  </script>
</body>
</html>
